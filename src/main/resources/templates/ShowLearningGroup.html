<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <div th:replace="fragments/header :: header"/>
    <script src='//cdn.tinymce.com/4/tinymce.min.js'></script>

</head>
<body>

<div th:replace="fragments/navbar :: loggedIn"></div>
<div class="row">
    <div class="small-12 small-offset-3 column">
        <h2>
            Welcome to the Group <span th:text="${learningGroup.name}"></span>!
        </h2>
    </div>
</div>

<div class="row">

    <div class="small-3 column">
        <table>

            <thead>
            <tr>
                <th><h4>Members:</h4></th>
            </tr>
            </thead>

            <tbody th:each="member: ${learningGroupMembers}">
            <td>
                <div th:text="${member.username}"></div>
            </td>
            </tbody>

        </table>
    </div>

    <!-- Displays for each group post in all group posts the title and text... -->
    <div class="small-6 columns">
        <div class="small-12 columns end" th:each="groupPost : ${groupPosts}">

            <div class="callout-card">
                <div class="card-label">
                    <!-- First three chars of the username are displayed -->
                    <div class="label-text" th:text="${groupPost.associatedUser.username.substring(0, 3)}">
                    </div>
                </div>
                <div class="callout-card-content">
                    <h3 class="lead" th:text="${groupPost.title}"> Title</h3>
                    <p th:utext="${groupPost.text}">Message Text</p>
                </div>
            </div>

            <!-- ... and after that, each comment that has the same associatedGroupId, as the current group post  -->
            <div class="small-10 columns end" th:each="comment : ${comments}">
                <div th:if="${comment.associatedGroupPost.id == groupPost.id}">

                    <div class="callout-card secondary">
                        <div class="card-label">
                            <div class="label-text" th:text="${comment.creator.username.substring(0, 3)}"></div>
                        </div>
                        <div class="callout-card-content">
                            <p th:utext="${comment.text}">Message Text</p>
                        </div>
                    </div>

                </div>
            </div>

            <div class="small-10 columns end">
                <form th:object="${comment}" th:action="@{/newComment(groupPostId=${groupPost.id})}"
                      method="post">

                    <p>Write a new comment!</p>

                    <textarea th:field="*{text}">Hello</textarea>

                    <div style="padding-top: 20px">
                        <button align="right" type="submit" class="button">Save comment</button>
                    </div>
                </form>
            </div>

        </div>
    </div>

    <!-- Button for the Modal (id=writeNewPostModal) -->
    <div class="small-3 columns">
        <a class="button fa fa-pencil" data-open="writeNewPostModal"> Create post</a>
    </div>

    <!-- Modal  -->
    <div class="reveal" id="writeNewPostModal" data-reveal="true">

        <div class="row">
            <div class="small-12 columns">
                <form th:object="${newGroupPost}" th:action="@{/newGroupPost(learningGroupId=${learningGroup.id})}"
                      method="post">

                    <p>Write a new group post!</p>

                    <div style="padding-bottom: 20px">
                        <input th:field="*{title}" placeholder="Title"/>
                    </div>

                    <textarea id="mytextareaforpost" th:field="*{text}">Hello</textarea>

                    <div style="padding-top: 20px">
                        <button align="right" type="submit" class="button">Save comment</button>
                    </div>
                </form>
            </div>
        </div>
        <button class="close-button" data-close="writeNewPostModal" aria-label="Close modal" type="button">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>

    <!-- js for the Modal -->
    <script>
        tinymce.init({
            selector: '#mytextareaforpost',
            statusbar: false,
            toolbar: "undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist | "
        });

        tinymce.init({
            statusbar: false,
            toolbar: "undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist | "
        });
    </script>
</div>

<script src="js/app.js"></script>

</body>
</html>